//0.1.1
"use strict";function _typeof(a){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function eva_toolbox_chart(a,b,c,d,e){if("undfined"===document)throw Error("DOM is required");var f=function(){var g,h=jsaltt.extend({},h);g="object"===_typeof(c)?c:c.split(",");var i=h.timeframe;i||(i="1D");var j=h.fill;j||(j="30T:2");var k=h.update,l=h.prop,m=document.getElementById(a),n=h.u,o=null;if(e&&(o=e),void 0!==e&&(0>=m.offsetWidth||0>=m.offsetHeight))return void(o&&o.destroy());var p=new Date;"T"==i[i.length-1]?p.setMinutes(p.getMinutes()-i.substring(0,i.length-1)):"H"==i[i.length-1]?p.setHours(p.getHours()-i.substring(0,i.length-1)):"D"==i[i.length-1]&&p.setHours(p.getHours()-24*i.substring(0,i.length-1)),e||eva_toolbox_animate(a);var d="value";void 0!==l&&null!==l&&(d=l),$eva.call("state_history",g,{t:"iso",s:p.toISOString(),x:d,w:j}).then(function(a){if(o){o.data.labels=a.t;for(var c=0;c<g.length;c++)o.data.datasets[c].data=a[g[c]+"/"+d];o.update()}else{var e=document.createElement("canvas");e.style.width="100%",e.style.height="100%",e.className="eva_toolbox_chart";var f=jsaltt.extend({},b);f.data.labels=a.t;for(var c=0;c<g.length;c++)f.data.datasets[c].data=a[g[c]+"/"+d];m.innerHTML="",m.appendChild(e),o=new Chart(e,f),n&&(f.options.tooltips.callbacks.label=function(a){return a.yLabel+n})}})["catch"](function(a){var b=document.createElement("div");b.className="eva_toolbox_chart",b.style.cssText="width: 100%; height: 100%; color: red; font-weight: bold; font-size: 14px",b.innerHTML="Error loading chart data: "+a.message,m.innerHTML="",m.appendChild(b),o&&o.destroy(),o=null}),k&&setTimeout(function(){f(a,b,g,h,o)},1e3*k)};f()}function eva_toolbox_animate(a){if("undfined"===document)throw Error("DOM is required");document.getElementById(a).innerHTML="<div class=\"eva-toolbox-cssload-square\"><div       class=\"eva-toolbox-cssload-square-part       eva-toolbox-cssload-square-green\"></div><div       class=\"eva-toolbox-cssload-square-part       eva-toolbox-cssload-square-pink\"></div><div       class=\"eva-toolbox-cssload-square-blend\"></div></div>"}function eva_toolbox_hiQR(a,b){if("undfined"===document)throw Error("DOM is required");var b=b;b||(b={});var c=b.url;c||(c=document.location);var d=b.user;void 0===d&&(d=$eva.authorized_user);var e=b.password;void 0===e&&(e=$eva.password);var f=b.size;if(f||(f=200),!c||!d)return!1;var g=document.createElement("a");g.href=c;var h=g.protocol.substring(0,g.protocol.length-1),i=g.hostname,j=g.port;j||("http"==h?j=80:j=443);var k="scheme:"+h+"|address:"+i+"|port:"+j+"|user:"+d;return e&&(k+="|password:"+e),new QRious({element:document.getElementById(a),value:k,size:f})}function eva_toolbox_popup(a,b,c,d,e){var e=e;return e||(e={}),new Promise(function(f,g){if("undfined"===document)throw Error("DOM is required");var h=document.getElementById(a);if(void 0===h||null===h)throw Error("DOM context ".concat(a," not found"));var i=e.ct,j=e.btn1,k=e.btn2,l=e.va,m=b;"!"==b[0]&&(m=b.substr(1));var n=function(a){return"info"==a?20:"warning"==a?30:"error"==a?40:0};if(h&&n(h.priority)>n(m))throw Error("popup with higher priority is already active");h&&(clearInterval(h.ticker),document.removeEventListener("keydown",h.key_listener)),h.innerHTML="",h.priority=m,h.className="eva_toolbox_popup";var o=document.createElement("div");h.appendChild(o),o.className="!"==b[0]?"eva_toolbox_popup_window_big":"eva_toolbox_popup_window";var p=document.createElement("div");p.className="eva_toolbox_popup_header eva_toolbox_popup_header_"+m,p.innerHTML=void 0!==c&&null!==c?c:m.charAt(0).toUpperCase()+m.slice(1),o.append(p);var q=document.createElement("div");q.className="eva_toolbox_popup_content",q.innerHTML=d,o.appendChild(q);var r=document.createElement("div");r.className="eva_toolbox_popup_footer",o.appendChild(r);var s=document.createElement("div");s.className="row",o.appendChild(s);var t=document.createElement("div"),u=document.createElement("div"),v=document.createElement("div");v.className="col-xs-1 col-sm-2",s.appendChild(v),s.appendChild(t),s.appendChild(u),v=document.createElement("div"),v.className="col-xs-1 col-sm-2",s.appendChild(v);var w="OK";j&&(w=j);var x=document.createElement("div");x.className="eva_toolbox_popup_btn eva_toolbox_popup_btn_"+m,x.innerHTML=w;var y=function(){clearInterval(h.ticker),document.getElementById(a).style.display="none",document.getElementById(a).innerHTML="",document.removeEventListener("keydown",h.key_listener),h.priority=null},z=function(){(void 0===l||null==l||l())&&(y(),f(!0))};x.addEventListener("click",z),t.appendChild(x);var A;if(k?(A=document.createElement("div"),A.className="eva_toolbox_popup_btn eva_toolbox_popup_btn_"+m,A.innerHTML=k,A.addEventListener("click",function(){y(),g(!0)}),u.appendChild(A),t.className+=" col-xs-5 col-sm-4",u.className+=" col-xs-5 col-sm-4"):(t.className+=" col-xs-10 col-sm-8",u.style.display="none"),h.style.display="block",h.key_listener=function(a){27==a.which&&(y(),g(),a.preventDefault()),13==a.which&&(z(),a.preventDefault())},document.addEventListener("keydown",h.key_listener),i&&0<i){h.ct=i;var B=function(){0>=h.ct&&(y(),g());var a,b="";A?(a=A,b=k):(a=x,b=w),a.innerHTML="".concat(b," (").concat(h.ct,")"),h.ct-=1};B(),h.ticker=setInterval(B,1e3)}})}"undefined"!=typeof $eva&&(!$eva.toolbox&&($eva.toolbox={}),$eva.toolbox.chart=eva_toolbox_chart,$eva.toolbox.animate=eva_toolbox_animate,$eva.toolbox.hiQR=eva_toolbox_hiQR,$eva.toolbox.popup=eva_toolbox_popup),"undefined"!=typeof exports&&(exports.chart=eva_toolbox_chart,exports.animate=eva_toolbox_animate,exports.hiQR=eva_toolbox_hiQR,exports.popup=eva_toolbox_popup);

